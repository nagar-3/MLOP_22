(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#  docker build -t quiz4:v1  .
Sending build context to Docker daemon  22.02kB
Step 1/5 : FROM python:3.8.1
 ---> efdecc2e377a
Step 2/5 : COPY  ./*  /exp/
 ---> 197802ad9679
Step 3/5 : RUN pip3 install --no-cache-dir -r /exp/requirement.txt
 ---> Running in a32a72a2b199
Collecting matplotlib==3.2
  Downloading matplotlib-3.2.0-cp38-cp38-manylinux1_x86_64.whl (12.4 MB)
Collecting flask==2.2.2
  Downloading Flask-2.2.2-py3-none-any.whl (101 kB)
Collecting scikit-learn==0.24.1
  Downloading scikit_learn-0.24.1-cp38-cp38-manylinux2010_x86_64.whl (24.9 MB)
Collecting scikit-image==0.17.1
  Downloading scikit_image-0.17.1-cp38-cp38-manylinux1_x86_64.whl (12.3 MB)
Collecting statistics==3.4.0b3
  Downloading statistics-3.4.0b3-py2.py3-none-any.whl (9.2 kB)
Collecting cycler>=0.10
  Downloading cycler-0.11.0-py3-none-any.whl (6.4 kB)
Collecting python-dateutil>=2.1
  Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)
Collecting pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1
  Downloading pyparsing-3.0.9-py3-none-any.whl (98 kB)
Collecting numpy>=1.11
  Downloading numpy-1.23.4-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
Collecting kiwisolver>=1.0.1
  Downloading kiwisolver-1.4.4-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl (1.2 MB)
Collecting importlib-metadata>=3.6.0; python_version < "3.10"
  Downloading importlib_metadata-5.0.0-py3-none-any.whl (21 kB)
Collecting Jinja2>=3.0
  Downloading Jinja2-3.1.2-py3-none-any.whl (133 kB)
Collecting Werkzeug>=2.2.2
  Downloading Werkzeug-2.2.2-py3-none-any.whl (232 kB)
Collecting click>=8.0
  Downloading click-8.1.3-py3-none-any.whl (96 kB)
Collecting itsdangerous>=2.0
  Downloading itsdangerous-2.1.2-py3-none-any.whl (15 kB)
Collecting joblib>=0.11
  Downloading joblib-1.2.0-py3-none-any.whl (297 kB)
Collecting scipy>=0.19.1
  Downloading scipy-1.9.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (33.8 MB)
Collecting threadpoolctl>=2.0.0
  Downloading threadpoolctl-3.1.0-py3-none-any.whl (14 kB)
Collecting networkx>=2.0
  Downloading networkx-2.8.8-py3-none-any.whl (2.0 MB)
Collecting tifffile>=2019.7.26
  Downloading tifffile-2022.10.10-py3-none-any.whl (210 kB)
Collecting pooch>=0.5.2
  Downloading pooch-1.6.0-py3-none-any.whl (56 kB)
Collecting PyWavelets>=1.1.1
  Downloading PyWavelets-1.4.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.9 MB)
Collecting pillow!=7.1.0,!=7.1.1,>=4.3.0
  Downloading Pillow-9.3.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)
Collecting imageio>=2.3.0
  Downloading imageio-2.22.4-py3-none-any.whl (3.4 MB)
Collecting docutils>=0.3
  Downloading docutils-0.19-py3-none-any.whl (570 kB)
Collecting six>=1.5
  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)
Collecting zipp>=0.5
  Downloading zipp-3.10.0-py3-none-any.whl (6.2 kB)
Collecting MarkupSafe>=2.0
  Downloading MarkupSafe-2.1.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)
Collecting requests>=2.19.0
  Downloading requests-2.28.1-py3-none-any.whl (62 kB)
Collecting packaging>=20.0
  Downloading packaging-21.3-py3-none-any.whl (40 kB)
Collecting appdirs>=1.3.0
  Downloading appdirs-1.4.4-py2.py3-none-any.whl (9.6 kB)
Collecting certifi>=2017.4.17
  Downloading certifi-2022.9.24-py3-none-any.whl (161 kB)
Collecting charset-normalizer<3,>=2
  Downloading charset_normalizer-2.1.1-py3-none-any.whl (39 kB)
Collecting urllib3<1.27,>=1.21.1
  Downloading urllib3-1.26.12-py2.py3-none-any.whl (140 kB)
Collecting idna<4,>=2.5
  Downloading idna-3.4-py3-none-any.whl (61 kB)
Installing collected packages: cycler, six, python-dateutil, pyparsing, numpy, kiwisolver, matplotlib, zipp, importlib-metadata, MarkupSafe, Jinja2, Werkzeug, click, itsdangerous, flask, joblib, scipy, threadpoolctl, scikit-learn, networkx, tifffile, certifi, charset-normalizer, urllib3, idna, requests, packaging, appdirs, pooch, PyWavelets, pillow, imageio, scikit-image, docutils, statistics
Successfully installed Jinja2-3.1.2 MarkupSafe-2.1.1 PyWavelets-1.4.1 Werkzeug-2.2.2 appdirs-1.4.4 certifi-2022.9.24 charset-normalizer-2.1.1 click-8.1.3 cycler-0.11.0 docutils-0.19 flask-2.2.2 idna-3.4 imageio-2.22.4 importlib-metadata-5.0.0 itsdangerous-2.1.2 joblib-1.2.0 kiwisolver-1.4.4 matplotlib-3.2.0 networkx-2.8.8 numpy-1.23.4 packaging-21.3 pillow-9.3.0 pooch-1.6.0 pyparsing-3.0.9 python-dateutil-2.8.2 requests-2.28.1 scikit-image-0.17.1 scikit-learn-0.24.1 scipy-1.9.3 six-1.16.0 statistics-3.4.0b3 threadpoolctl-3.1.0 tifffile-2022.10.10 urllib3-1.26.12 zipp-3.10.0
WARNING: You are using pip version 20.0.2; however, version 22.3.1 is available.
You should consider upgrading via the '/usr/local/bin/python -m pip install --upgrade pip' command.

Removing intermediate container a32a72a2b199
 ---> bcd667779065
Step 4/5 : WORKDIR /exp
 ---> Running in 8fbf3d55f350
Removing intermediate container 8fbf3d55f350
 ---> 4821a3802d59
Step 5/5 : EXPOSE 5000/tcp
 ---> Running in 7a31cdff1086
Removing intermediate container 7a31cdff1086
 ---> 347f3e4b1bd1
Successfully built 347f3e4b1bd1
Successfully tagged quiz4:v1
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# ls -lrth
total 20K
drwxr-xr-x 3 root root 4.0K Nov 14 00:36 utills
-rwxrwxrwx 1 root root 3.3K Nov 14 09:50 Classification_quiz_4_bonus.py
-rwxrwxrwx 1 root root 3.3K Nov 14 09:54 Classification_quiz_4_Q1.py
-rw-r--r-- 1 root root  139 Nov 14 09:55 requirement.txt
-rwxrwxrwx 1 root root  140 Nov 14 10:18 Dockerfile
(my_conda_env) root@mlops:~/MLOP_22/docker# cat Dockerfile
#FROM ubuntu:latest
FROM python:3.8.1
COPY  ./*  /exp/
RUN pip3 install --no-cache-dir -r /exp/requirement.txt
WORKDIR /exp
EXPOSE 5000/tcp
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker run --name quiz4_sol -it quiz4:v1 /bin/bash
root@00383c475b07:/exp#
root@00383c475b07:/exp#
root@00383c475b07:/exp# (my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker container  ls
CONTAINER ID   IMAGE      COMMAND       CREATED          STATUS          PORTS      NAMES
00383c475b07   quiz4:v1   "/bin/bash"   15 seconds ago   Up 14 seconds   5000/tcp   quiz4_sol
(my_conda_env) root@mlops:~/MLOP_22/docker# docker container  ps -a
CONTAINER ID   IMAGE      COMMAND       CREATED          STATUS          PORTS      NAMES
00383c475b07   quiz4:v1   "/bin/bash"   19 seconds ago   Up 17 seconds   5000/tcp   quiz4_sol
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# date
Mon Nov 14 10:23:08 IST 2022
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker exec -it quiz4_sol /bin/bash
root@00383c475b07:/exp#


root@00383c475b07:/exp# python3 Classification_quiz_4_Q1.py


 Model Comparsion in progress..................

 * Serving Flask app 'Classification_quiz_4_Q1'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://172.17.0.2:5000
Press CTRL+C to quit


172.17.0.1 - - [14/Nov/2022 04:59:42] "POST /svm HTTP/1.1" 201 -
^Croot@00383c475b07:/exp#
root@00383c475b07:/exp# date
Mon Nov 14 05:01:31 UTC 2022
root@00383c475b07:/exp#





Login to container
----------------------------------------------------------------------------------

(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker run --name quiz4_sol -it quiz4:v1 /bin/bash
root@00383c475b07:/exp#
root@00383c475b07:/exp#
root@00383c475b07:/exp# (my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker container  ls
CONTAINER ID   IMAGE      COMMAND       CREATED          STATUS          PORTS      NAMES
00383c475b07   quiz4:v1   "/bin/bash"   15 seconds ago   Up 14 seconds   5000/tcp   quiz4_sol
(my_conda_env) root@mlops:~/MLOP_22/docker# docker container  ps -a
CONTAINER ID   IMAGE      COMMAND       CREATED          STATUS          PORTS      NAMES
00383c475b07   quiz4:v1   "/bin/bash"   19 seconds ago   Up 17 seconds   5000/tcp   quiz4_sol
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# date
Mon Nov 14 10:23:08 IST 2022
(my_conda_env) root@mlops:~/MLOP_22/docker#
(my_conda_env) root@mlops:~/MLOP_22/docker# docker exec -it quiz4_sol /bin/bash
root@00383c475b07:/exp#
root@00383c475b07:/exp# 





Access app from outside container
----------------------------------------------------------------------------
(my_conda_env) root@mlops:~#
(my_conda_env) root@mlops:~# curl -X POST http://172.17.0.2:5000/svm  -H 'Content-Type: application/json' -d '{"img1": ["0.0","0.0","0.0","11.999999999999982","13.000000000000004","5.000000000000021","8.881784197001265e-15","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999988","9.000000000000005","1.598721155460224e-14","0.0","0.0","0.0","2.9999999999999925","14.999999999999979","15.999999999999998","6.000000000000022","1.0658141036401509e-14","0.0","6.217248937900871e-15","6.999999999999987","14.99999999999998","15.999999999999996","16.0","2.0000000000000284","3.552713678800507e-15","0.0","5.5220263365470826e-30","6.21724893790087e-15","1.0000000000000113","15.99999999999998","16.0","3.000000000000022","5.32907051820075e-15","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000015","1.0658141036401498e-14","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000018","1.0658141036401503e-14","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999993","10.00000000000001","1.7763568394002505e-14","0.0"],"img2": ["0.0","0.0","0.0","11.999999999999982","13.000000000000004","5.000000000000021","8.881784197001265e-15","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999988","9.000000000000005","1.598721155460224e-14","0.0","0.0","0.0","2.9999999999999925","14.999999999999979","15.999999999999998","6.000000000000022","1.0658141036401509e-14","0.0","6.217248937900871e-15","6.999999999999987","14.99999999999998","15.999999999999996","16.0","2.0000000000000284","3.552713678800507e-15","0.0","5.5220263365470826e-30","6.21724893790087e-15","1.0000000000000113","15.99999999999998","16.0","3.000000000000022","5.32907051820075e-15","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000015","1.0658141036401498e-14","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000018","1.0658141036401503e-14","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999993","10.00000000000001","1.7763568394002505e-14","0.0"]}'

{"Image#1":1,"Image#2":1,"Result ":"Both image are same"}
(my_conda_env) root@mlops:~#
(my_conda_env) root@mlops:~#
(my_conda_env) root@mlops:~#
(my_conda_env) root@mlops:~# date
Mon Nov 14 10:29:44 IST 2022
(my_conda_env) root@mlops:~# ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:f6:f7:24 brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3
       valid_lft 86232sec preferred_lft 86232sec
    inet6 fe80::84c1:348e:de74:8f8f/64 scope link noprefixroute
       valid_lft forever preferred_lft forever
3: enp0s8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:74:86:5f brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.122/24 brd 192.168.56.255 scope global dynamic noprefixroute enp0s8
       valid_lft 476sec preferred_lft 476sec
    inet6 fe80::ff7f:c976:93ac:c187/64 scope link noprefixroute
       valid_lft forever preferred_lft forever
4: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:bf:3d:5e:4a brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:bfff:fe3d:5e4a/64 scope link
       valid_lft forever preferred_lft forever
80: vethf551477@if79: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default
    link/ether 86:0c:6e:18:30:1a brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet6 fe80::840c:6eff:fe18:301a/64 scope link
       valid_lft forever preferred_lft forever
(my_conda_env) root@mlops:~#






Bonus Question SOl
#######################################################

Container running on http://172.17.0.2
--------------------------------------------
root@00383c475b07:/exp#
root@00383c475b07:/exp#
root@00383c475b07:/exp#
root@00383c475b07:/exp# python Classification_quiz_4_bonus.py
 * Serving Flask app 'Classification_quiz_4_bonus'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://172.17.0.2:5000
Press CTRL+C to quit


172.17.0.1 - - [14/Nov/2022 06:17:18] "POST /svm HTTP/1.1" 201 -
^Croot@00383c475b07:/exp#
root@00383c475b07:/exp#
root@00383c475b07:/exp#



model present on 172.17.0.1
-------------------------------------------
(my_conda_env) root@mlops:~/MLOP_22#
(my_conda_env) root@mlops:~/MLOP_22#
(my_conda_env) root@mlops:~/MLOP_22# python Bonus_Q2_Machine_2_code.py
 * Serving Flask app 'Bonus_Q2_Machine_2_code'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://172.17.0.1:5000
Press CTRL+C to quit
172.17.0.2 - - [14/Nov/2022 11:47:18] "POST /predict HTTP/1.1" 201 -
(my_conda_env) root@mlops:~/MLOP_22#
(my_conda_env) root@mlops:~/MLOP_22#


============================================================================
Testing results
(base) root@mlops:~/MLOP_22#
(base) root@mlops:~/MLOP_22#
(base) root@mlops:~/MLOP_22# curl -X POST http://172.17.0.2:5000/svm  -H 'Content-Type: application/json' -d '{"img1": ["0.0","0.0","0.0","11.999999999999982","13.000000000000004","5.000000000000021","8.881784197001265e-15","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999988","9.000000000000005","1.598721155460224e-14","0.0","0.0","0.0","2.9999999999999925","14.999999999999979","15.999999999999998","6.000000000000022","1.0658141036401509e-14","0.0","6.217248937900871e-15","6.999999999999987","14.99999999999998","15.999999999999996","16.0","2.0000000000000284","3.552713678800507e-15","0.0","5.5220263365470826e-30","6.21724893790087e-15","1.0000000000000113","15.99999999999998","16.0","3.000000000000022","5.32907051820075e-15","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000015","1.0658141036401498e-14","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000018","1.0658141036401503e-14","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999993","10.00000000000001","1.7763568394002505e-14","0.0"],"img2": ["0.0","0.0","0.0","11.999999999999982","13.000000000000004","5.000000000000021","8.881784197001265e-15","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999988","9.000000000000005","1.598721155460224e-14","0.0","0.0","0.0","2.9999999999999925","14.999999999999979","15.999999999999998","6.000000000000022","1.0658141036401509e-14","0.0","6.217248937900871e-15","6.999999999999987","14.99999999999998","15.999999999999996","16.0","2.0000000000000284","3.552713678800507e-15","0.0","5.5220263365470826e-30","6.21724893790087e-15","1.0000000000000113","15.99999999999998","16.0","3.000000000000022","5.32907051820075e-15","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000015","1.0658141036401498e-14","0.0","0.0","0.0","0.9999999999999989","15.99999999999998","16.0","6.000000000000018","1.0658141036401503e-14","0.0","0.0","0.0","0.0","10.999999999999986","15.999999999999993","10.00000000000001","1.7763568394002505e-14","0.0"]}'
{"Image#1":1,"Image#2":1,"Result ":"Both image are same"}
(base) root@mlops:~/MLOP_22#
(base) root@mlops:~/MLOP_22#
(base) root@mlops:~/MLOP_22#
